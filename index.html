<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <title>Карта предприятий с маршрутами</title>

  <!-- Яндекс с полным пакетом и CORS -->
  <script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU&load=package.full&cors=1"></script>

  <!-- наш код -->
  <script defer src="app.js"></script>

  <style>
    body { margin: 0; padding: 0; font-family: Arial, sans-serif; }
    #map { width: 100%; height: 600px; }
    .controls { padding: 15px; background: #f8f9fa; border-bottom: 1px solid #ddd; display: flex; gap: 10px; flex-wrap: wrap; align-items: center; }
    .control-group { display: flex; gap: 5px; align-items: center; }
    input, select, button { padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px; }
    button { background: #4285f4; color: white; border: none; cursor: pointer; }
    button:hover { background: #3367d6; }
    button:disabled { background: #ccc; cursor: not-allowed; }
    #routePanel { position: absolute; top: 80px; right: 20px; background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.2); z-index: 999; max-width: 300px; display: none; }
    .route-info { margin: 10px 0; }
    .route-point { display: flex; align-items: center; margin: 5px 0; padding: 5px; background: #f5f5f5; border-radius: 4px; }
    .remove-point { background: #ff4444; color: white; border: none; border-radius: 50%; width: 20px; height: 20px; margin-left: 10px; cursor: pointer; }
    #debug { position: fixed; left: 10px; bottom: 10px; right: 10px; max-height: 180px; overflow: auto; background: rgba(0,0,0,0.8); color: #fff; padding: 8px; border-radius: 6px; font-family: monospace; font-size: 12px; z-index: 2000; }
    #debug .line { margin-bottom: 4px; }
    #debug .error { color: #ff8080; }
    #debug .warn { color: #ffd580; }
    #debug .info { color: #b3ffb3; }
  </style>
</head>
<body>
  <div class="controls">
    <div class="control-group">
      <input type="text" id="searchInput" placeholder="Поиск по названию...">
      <button id="btnSearch">Найти</button>
    </div>

    <div class="control-group">
      <select id="typeFilter">
        <option value="">Все типы предприятий</option>
        <option value="мебельный">Мебельные</option>
        <option value="металлургия">Металлургия</option>
        <option value="пищевой">Пищевые</option>
      </select>
      <button id="btnFilter">Фильтровать</button>
    </div>

    <button id="btnShowAll">Показать все</button>
    <button id="routeBtn">Построить маршрут</button>
    <button id="clearRouteBtn" disabled>Очистить маршрут</button>
    <button id="testSimpleRoute">Тест простого маршрута</button>
  </div>

  <div id="routePanel">
    <h3 style="margin-top: 0;">Маршрут</h3>
    <div id="routePoints"></div>
    <div class="control-group">
      <select id="routeType">
        <option value="auto">Автомобиль</option>
        <option value="masstransit">Общественный транспорт</option>
        <option value="pedestrian">Пешком</option>
      </select>
      <button id="btnCalculate">Рассчитать</button>
    </div>
    <div id="routeInfo" class="route-info"></div>
    <button id="btnClosePanel" style="background: #666;">Закрыть</button>
  </div>

  <div id="map"></div>
  <div id="debug" aria-hidden="false"></div>
</body>
</html>
